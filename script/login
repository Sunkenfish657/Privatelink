document.addEventListener('DOMContentLoaded', () => {

    // ===== ELEMEN YANG DIBUTUHKAN =====
    const pages = document.querySelectorAll('.page');
    const loginForm = document.getElementById('login-form');
    const displayAccountName = document.getElementById('display-account-name');
    const logoutButton = document.getElementById('logout-button');
    const backButtons = document.querySelectorAll('.back-button');

    // Tombol untuk menampilkan tools
    const showHashToolBtn = document.getElementById('show-hash-tool');
    const showEmbedToolBtn = document.getElementById('show-embed-tool');

    // Elemen Tool Hash
    const generateHashBtn = document.getElementById('generate-hash-btn');
    const hashInput = document.getElementById('hash-input');
    const hashOutput = document.getElementById('hash-output');
    const hashAlgorithm = document.getElementById('hash-algorithm');

    // ===== FUNGSI UNTUK NAVIGASI HALAMAN =====
    function showPage(pageId) {
        pages.forEach(page => {
            page.classList.remove('active');
        });
        document.getElementById(pageId).classList.add('active');
    }

    // ===== LOGIKA LOGIN & LOGOUT =====
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault(); // Mencegah form reload halaman
        const accountName = document.getElementById('account-name').value;
        displayAccountName.textContent = accountName; // Tampilkan nama akun di nav
        showPage('main-menu-page'); // Pindah ke halaman menu utama
    });

    logoutButton.addEventListener('click', () => {
        loginForm.reset(); // Kosongkan form login
        showPage('login-page'); // Kembali ke halaman login
    });

    // ===== NAVIGASI MENU UTAMA KE TOOLS =====
    showHashToolBtn.addEventListener('click', () => showPage('hash-tool-page'));
    showEmbedToolBtn.addEventListener('click', () => showPage('embed-tool-page'));

    // Fungsi tombol kembali di setiap tool
    backButtons.forEach(button => {
        button.addEventListener('click', () => showPage('main-menu-page'));
    });

    // ===== FUNGSI TOOL GENERATE HASH =====
    generateHashBtn.addEventListener('click', async () => {
        const text = hashInput.value;
        const algorithm = hashAlgorithm.value;

        if (!text) {
            hashOutput.textContent = "Silakan masukkan teks terlebih dahulu.";
            return;
        }

        try {
            const encoder = new TextEncoder();
            const data = encoder.encode(text);
            const hashBuffer = await crypto.subtle.digest(algorithm, data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            hashOutput.textContent = hashHex;
        } catch (error) {
            hashOutput.textContent = `Error: ${error.message}`;
        }
    });

    // Inisialisasi: Tampilkan halaman login saat pertama kali dibuka
    showPage('login-page');
});